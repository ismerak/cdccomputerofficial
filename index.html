<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="cdcicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CDC Computer - á á¶á„á›á€áŸ‹á€á»áŸ†á–áŸ’á™á¼á‘áŸáš</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@300;400;700&display=swap" rel="stylesheet" />
    <style>
        body { font-family: "Kantumruy Pro", sans-serif; background-color: #f8fafc; scroll-behavior: smooth; }
        .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); }
        .category-tab.active { background-color: #2563eb; color: white; border-color: #2563eb; }
        .loader { border: 3px solid #e2e8f0; border-top: 3px solid #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .modal-active { overflow: hidden; }
        .cart-badge { position: absolute; top: -5px; right: -5px; background: #ef4444; color: white; border-radius: 50%; padding: 2px 6px; font-size: 10px; font-weight: bold; }
        /* áŸá˜áŸ’ášá¶á”áŸ‹áŸáŸ’á€áŸ’ášá¼á›á”á¶ášáŸáŸ’á¢á¶á */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="antialiased text-gray-900">

    <!-- Top Bar -->
    <div class="bg-gray-900 text-white py-2 text-xs">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <a href="https://web.facebook.com/CDC.Computer.Cambodia" target="_blank" class="hover:text-blue-400 flex items-center gap-1 transition-colors">Facebook</a>
                <a href="https://t.me/CDCCOMPUTER093" target="_blank" class="hover:text-blue-300 flex items-center gap-1 transition-colors">Telegram</a>
            </div>
            <div class="flex items-center gap-3 font-bold">
                <span class="hidden sm:inline">á‘áŸ†á“á¶á€áŸ‹á‘áŸ†á“á„áŸ– </span>
                <span>093 844 884 / 099 844 884</span>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white border-b sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <!-- Logo -->
            <div class="flex items-center gap-3 cursor-pointer group" onclick="location.reload()">
                <img src="cdcicon.png" class="h-10 w-10 group-hover:scale-110 transition-transform" alt="Logo">
                <div class="leading-tight">
                    <h1 class="text-lg font-bold text-gray-800 uppercase leading-none">CDC Computer</h1>
                    <p class="text-[10px] text-blue-600 font-medium tracking-widest">TECHNOLOGY STORE</p>
                </div>
            </div>

            <!-- Desktop Search -->
            <div class="hidden md:flex items-center flex-1 justify-center px-8">
                <div class="relative w-full max-w-md">
                    <input type="text" id="searchInput" placeholder="áŸáŸ’áœáŸ‚á„ášá€á‘áŸ†á“á·á‰áŠáŸ‚á›á¢áŸ’á“á€á…á„áŸ‹á”á¶á“..." class="w-full pl-10 pr-4 py-2 bg-gray-100 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all border border-transparent focus:bg-white">
                    <span class="absolute left-3 top-2.5 text-gray-400">
                        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    </span>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex items-center gap-2 sm:gap-4">
                <button onclick="toggleWishlistDisplay()" class="relative p-2 text-gray-600 hover:text-red-500 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                    <span id="wishlistCount" class="cart-badge hidden">0</span>
                </button>
                <button onclick="toggleCart()" class="relative p-2 text-gray-600 hover:text-blue-600 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                    <span id="cartCount" class="cart-badge hidden">0</span>
                </button>
            </div>
        </div>
        
        <!-- Mobile Search & Category Tabs -->
        <div class="border-t">
            <div class="md:hidden px-4 py-2">
                <input type="text" id="searchInputMobile" placeholder="áŸáŸ’áœáŸ‚á„ášá€á‘áŸ†á“á·á‰..." class="w-full px-4 py-2 bg-gray-100 rounded-xl text-sm focus:outline-none border border-gray-200">
            </div>
            <!-- Category Scroll -->
            <div id="categoryContainer" class="container mx-auto px-4 py-3 flex gap-2 overflow-x-auto no-scrollbar whitespace-nowrap">
                <button onclick="filterByCategory('á‘á¶áŸ†á„á¢áŸáŸ‹')" class="category-tab active px-4 py-1.5 rounded-full border text-sm font-medium transition-all hover:border-blue-500">á‘á¶áŸ†á„á¢áŸáŸ‹</button>
                <!-- á“á¹á„á”á‰áŸ’á…á¼á›áŠáŸ„á™ JS -->
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6">
        <!-- Loading State -->
        <div id="loading" class="flex flex-col items-center justify-center py-24">
            <div class="loader mb-4"></div>
            <p class="text-gray-500 animate-pulse">á€áŸ†á–á»á„ášáŸ€á”á…áŸ†á‘áŸ†á“á·á‰á‡á¼á“á¢áŸ’á“á€...</p>
        </div>

        <!-- Product Grid -->
        <div id="productGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 hidden"></div>

        <!-- Load More -->
        <div id="loadMoreContainer" class="mt-12 text-center hidden">
            <button id="loadMoreBtn" class="bg-white border-2 border-blue-600 text-blue-600 px-10 py-2.5 rounded-full font-bold hover:bg-blue-600 hover:text-white transition-all transform active:scale-95 shadow-sm">á”á„áŸ’á á¶á‰á”á“áŸ’ááŸ‚á˜</button>
        </div>

        <!-- No Results -->
        <div id="noResults" class="hidden text-center py-24">
            <div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-400">
                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 9.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            </div>
            <p class="text-gray-500 font-medium">á˜á·á“á˜á¶á“á‘áŸ†á“á·á‰áŠáŸ‚á›á¢áŸ’á“á€áŸáŸ’áœáŸ‚á„ášá€á‘áŸ</p>
            <button onclick="location.reload()" class="mt-4 text-blue-600 underline">á”á„áŸ’á á¶á‰á‘á¶áŸ†á„á¢áŸáŸ‹á¡á¾á„áœá·á‰</button>
        </div>
    </main>

    <!-- Product Modal -->
    <div id="productModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 hidden p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative shadow-2xl animate-in zoom-in duration-300">
            <button onclick="closeModal()" class="absolute top-4 right-4 z-10 p-2 bg-white/80 rounded-full text-gray-500 hover:text-black shadow transition-all">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
            </button>
            <div id="modalContent" class="p-6 md:p-10"></div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div id="cartSidebar" class="fixed inset-y-0 right-0 z-50 w-full max-w-md bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out hidden flex flex-col">
        <div class="p-4 border-b flex justify-between items-center bg-gray-50">
            <div class="flex items-center gap-2">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                <h2 class="font-bold text-lg">á€á“áŸ’ááŸ’ášá€á‘áŸ†á“á·á‰ášá”áŸáŸ‹á¢áŸ’á“á€</h2>
            </div>
            <button onclick="toggleCart()" class="text-gray-400 hover:bg-gray-200 p-1.5 rounded-full transition-colors"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
        </div>
        
        <div id="cartItems" class="flex-grow overflow-y-auto p-4 space-y-4">
            <!-- Items injected by JS -->
        </div>
        
        <div class="p-4 border-t bg-gray-50 space-y-4">
            <div class="space-y-3">
                <input type="text" id="custName" placeholder="áˆáŸ’á˜áŸ„áŸ‡á¢áŸ’á“á€á‘á·á‰ *" class="w-full px-4 py-2.5 text-sm border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                <input type="text" id="custPhone" placeholder="á›áŸáá‘á¼ášáŸáŸá–áŸ’á‘ *" class="w-full px-4 py-2.5 text-sm border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                <textarea id="custAddress" placeholder="á‘á¸áá¶áŸ†á„ á¬á¢á¶áŸá™áŠáŸ’á‹á¶á“áŠá¹á€á‡á‰áŸ’á‡á¼á“ *" class="w-full px-4 py-2 text-sm border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none h-20 transition-all"></textarea>
            </div>
            
            <div class="flex justify-between items-center font-bold text-xl px-2">
                <span class="text-gray-600">áŸášá»á”áŸ–</span>
                <span id="cartTotal" class="text-blue-600">$0.00</span>
            </div>

            <button onclick="orderViaTelegram()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 hover:bg-blue-700 active:scale-[0.98] transition-all shadow-lg shadow-blue-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.891 8.146l-2.003 9.445c-.149.659-.538.822-1.088.513l-3.051-2.247-1.472 1.417c-.163.163-.3.3-.614.3l.219-3.107 5.654-5.108c.246-.219-.054-.341-.38-.124l-6.99 4.402-3.012-.942c-.655-.205-.668-.655.137-.969l11.771-4.535c.545-.203 1.021.124.829.949z"/></svg>
                á”á‰áŸ’á‡á¶á‘á·á‰áá¶á˜ Telegram
            </button>
        </div>
    </div>

    <script>
        const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTlrxWsu4bchDXwiDcitxq71ZJAVmpkEeAdBvRXox9OWiDS5O1qwBetSjcFjmuRVP7FeZIF609O2n1H/pub?gid=0&single=true&output=csv";
        const TELEGRAM_USER = "CDCCOMPUTER093"; 
        
        let allProducts = [];
        let filteredProducts = [];
        let displayedCount = 15;
        let cart = [];
        let wishlist = [];
        let currentCategory = 'á‘á¶áŸ†á„á¢áŸáŸ‹';

        async function fetchProducts() {
            try {
                const response = await fetch(CSV_URL);
                const data = await response.text();
                const rows = data.split(/\r?\n/).slice(1);
                
                allProducts = rows.map((row, index) => {
                    const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    if (cols.length < 2) return null;
                    return {
                        id: index,
                        name: cols[0]?.replace(/"/g, "").trim(),
                        price: parseFloat(cols[1]?.replace(/"/g, "").trim()) || 0,
                        category: cols[2]?.replace(/"/g, "").trim() || "á•áŸ’áŸáŸá„áŸ—",
                        image: cols[3]?.replace(/"/g, "").trim() || "https://via.placeholder.com/400x400?text=No+Image",
                        desc: cols[4]?.replace(/"/g, "").trim() || "á˜á·á“á˜á¶á“á€á¶ášá”ášá·á™á¶á™á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·á..."
                    };
                }).filter(p => p && p.name);

                generateCategories();
                filteredProducts = allProducts;
                renderProducts();
                document.getElementById("loading").classList.add("hidden");
            } catch (err) {
                console.error(err);
                document.getElementById("loading").innerHTML = `<p class="text-red-500">á€á¶ášá‘á¶á‰á‘á·á“áŸ’á“á“áŸá™á˜á¶á“á”á‰áŸ’á á¶áŸ” áŸá¼á˜á–áŸ’á™á¶á™á¶á˜á˜áŸ’áá„á‘áŸ€á!</p>`;
            }
        }

        function generateCategories() {
            const categories = ['á‘á¶áŸ†á„á¢áŸáŸ‹', ...new Set(allProducts.map(p => p.category))];
            const container = document.getElementById("categoryContainer");
            container.innerHTML = "";
            
            categories.forEach(cat => {
                if(!cat) return;
                const btn = document.createElement("button");
                btn.className = `category-tab px-5 py-1.5 rounded-full border text-sm font-medium transition-all hover:bg-gray-100 ${cat === currentCategory ? 'active' : ''}`;
                btn.innerText = cat;
                btn.onclick = () => filterByCategory(cat);
                container.appendChild(btn);
            });
        }

        function filterByCategory(category) {
            currentCategory = category;
            
            // Update Active Tab UI
            document.querySelectorAll('.category-tab').forEach(btn => {
                if(btn.innerText === category) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            if (category === 'á‘á¶áŸ†á„á¢áŸáŸ‹') {
                filteredProducts = allProducts;
            } else {
                filteredProducts = allProducts.filter(p => p.category === category);
            }
            
            renderProducts(true);
            // Scroll categories to view
            const activeBtn = document.querySelector('.category-tab.active');
            activeBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }

        function renderProducts(reset = true) {
            const grid = document.getElementById("productGrid");
            if (reset) { displayedCount = 15; grid.innerHTML = ""; }
            
            const items = filteredProducts.slice(0, displayedCount);
            grid.innerHTML = ""; 

            items.forEach(p => {
                const isLoved = wishlist.includes(p.id);
                const div = document.createElement("div");
                div.className = "product-card bg-white rounded-2xl border border-gray-100 overflow-hidden flex flex-col relative group cursor-pointer animate-in fade-in slide-in-from-bottom-4 duration-500";
                div.onclick = (e) => { if(!e.target.closest('button')) openDetails(p.id); };

                div.innerHTML = `
                    <div class="relative aspect-square overflow-hidden bg-gray-50">
                        <img src="${p.image}" class="w-full h-full object-cover group-hover:scale-105 transition duration-500" loading="lazy">
                        <div class="absolute top-2 left-2">
                             <span class="bg-black/50 backdrop-blur-md text-white text-[10px] px-2 py-0.5 rounded-lg uppercase tracking-wider font-bold">${p.category}</span>
                        </div>
                        <button onclick="toggleHeart(${p.id})" class="absolute top-2 right-2 p-2 bg-white/90 backdrop-blur rounded-full hover:bg-white shadow-sm transition-all active:scale-90">
                            <svg class="w-4 h-4 ${isLoved ? 'text-red-500 fill-current' : 'text-gray-400'}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                        </button>
                    </div>
                    <div class="p-3 flex flex-col flex-grow">
                        <h3 class="font-bold text-[13px] text-gray-800 line-clamp-2 mb-2 h-10 leading-snug">${p.name}</h3>
                        <div class="mt-auto flex justify-between items-center">
                            <span class="text-blue-600 font-extrabold text-base">$${p.price.toFixed(2)}</span>
                            <button onclick="addToCart(${p.id})" class="bg-blue-50 p-2 rounded-xl text-blue-600 hover:bg-blue-600 hover:text-white transition-all">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                            </button>
                        </div>
                    </div>
                `;
                grid.appendChild(div);
            });

            document.getElementById("loadMoreContainer").classList.toggle("hidden", displayedCount >= filteredProducts.length);
            document.getElementById("productGrid").classList.remove("hidden");
            document.getElementById("noResults").classList.toggle("hidden", filteredProducts.length > 0);
        }

        function openDetails(id) {
            const p = allProducts.find(x => x.id === id);
            const content = document.getElementById("modalContent");
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-10">
                    <div class="rounded-3xl overflow-hidden bg-gray-50 flex items-center justify-center border">
                        <img src="${p.image}" class="max-w-full max-h-[400px] object-contain p-6">
                    </div>
                    <div class="flex flex-col">
                        <div class="flex-grow">
                            <span class="inline-block px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold mb-3 uppercase tracking-widest">${p.category}</span>
                            <h2 class="text-2xl font-extrabold text-gray-800 mb-2">${p.name}</h2>
                            <div class="text-3xl font-black text-blue-600 mb-6">$${p.price.toFixed(2)}</div>
                            
                            <div class="mb-8">
                                <h4 class="font-bold text-gray-700 border-b pb-2 mb-3 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                    á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·á
                                </h4>
                                <p class="text-gray-600 text-sm leading-relaxed whitespace-pre-wrap">${p.desc}</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="addToCart(${p.id}); closeModal();" class="flex items-center justify-center gap-2 bg-gray-100 text-gray-800 py-3.5 rounded-2xl font-bold hover:bg-gray-200 transition-all">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
                                á€á“áŸ’ááŸ’ášá€
                            </button>
                            <button onclick="directOrder(${p.id})" class="bg-blue-600 text-white py-3.5 rounded-2xl font-bold hover:bg-blue-700 transition-all shadow-lg shadow-blue-100">á‘á·á‰á¥á¡á¼áœ</button>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById("productModal").classList.remove("hidden");
            document.body.classList.add("modal-active");
        }

        function closeModal() {
            document.getElementById("productModal").classList.add("hidden");
            document.body.classList.remove("modal-active");
        }

        function addToCart(id) {
            const p = allProducts.find(x => x.id === id);
            const exists = cart.find(x => x.id === id);
            if (exists) exists.quantity++;
            else cart.push({ ...p, quantity: 1 });
            updateCartUI();
        }

        function updateCartUI() {
            const cartItems = document.getElementById("cartItems");
            const cartTotal = document.getElementById("cartTotal");
            const cartCount = document.getElementById("cartCount");
            const wishCount = document.getElementById("wishlistCount");

            cartItems.innerHTML = "";
            let total = 0;
            let count = 0;

            if(cart.length === 0) {
                cartItems.innerHTML = `<div class="text-center py-20 text-gray-400"><p>á€á“áŸ’ááŸ’ášá€á‘áŸ†á“áŸáš...</p></div>`;
            }

            cart.forEach(item => {
                total += item.price * item.quantity;
                count += item.quantity;
                const div = document.createElement("div");
                div.className = "flex gap-3 bg-white p-3 rounded-2xl border border-gray-100 shadow-sm";
                div.innerHTML = `
                    <img src="${item.image}" class="w-16 h-16 object-cover rounded-xl border">
                    <div class="flex-grow">
                        <div class="text-[11px] font-bold line-clamp-1 text-gray-700">${item.name}</div>
                        <div class="text-blue-600 font-bold text-sm">$${item.price.toFixed(2)}</div>
                        <div class="flex items-center gap-3 mt-2">
                            <div class="flex items-center border rounded-lg bg-gray-50 overflow-hidden">
                                <button onclick="updateQty(${item.id}, -1)" class="w-7 h-7 flex items-center justify-center hover:bg-gray-200 transition-colors">-</button>
                                <span class="px-3 text-xs font-bold w-8 text-center">${item.quantity}</span>
                                <button onclick="updateQty(${item.id}, 1)" class="w-7 h-7 flex items-center justify-center hover:bg-gray-200 transition-colors">+</button>
                            </div>
                        </div>
                    </div>
                    <button onclick="removeFromCart(${item.id})" class="text-gray-300 hover:text-red-500 transition-colors self-center">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                    </button>
                `;
                cartItems.appendChild(div);
            });

            cartTotal.innerText = `$${total.toFixed(2)}`;
            cartCount.innerText = count;
            cartCount.classList.toggle("hidden", count === 0);
            
            wishCount.innerText = wishlist.length;
            wishCount.classList.toggle("hidden", wishlist.length === 0);
        }

        function updateQty(id, delta) {
            const item = cart.find(x => x.id === id);
            item.quantity += delta;
            if (item.quantity < 1) removeFromCart(id);
            else updateCartUI();
        }

        function removeFromCart(id) {
            cart = cart.filter(x => x.id !== id);
            updateCartUI();
        }

        function toggleCart() {
            const sb = document.getElementById("cartSidebar");
            if(sb.classList.contains('hidden')) {
                sb.classList.remove('hidden');
                setTimeout(() => sb.classList.remove('translate-x-full'), 10);
            } else {
                sb.classList.add('translate-x-full');
                setTimeout(() => sb.classList.add('hidden'), 300);
            }
        }

        function toggleHeart(id) {
            const index = wishlist.indexOf(id);
            if (index > -1) wishlist.splice(index, 1);
            else wishlist.push(id);
            renderProducts(false);
            updateCartUI();
        }

        function toggleWishlistDisplay() {
            if(wishlist.length === 0) return;
            filteredProducts = allProducts.filter(p => wishlist.includes(p.id));
            currentCategory = 'á…áŸ†áá¼á›á…á·ááŸ’á';
            renderProducts(true);
            document.querySelectorAll('.category-tab').forEach(b => b.classList.remove('active'));
        }

        function directOrder(id) {
            addToCart(id);
            toggleCart();
            closeModal();
        }

        function orderViaTelegram() {
            const name = document.getElementById("custName").value.trim();
            const phone = document.getElementById("custPhone").value.trim();
            const address = document.getElementById("custAddress").value.trim();

            if (cart.length === 0) return; 
            if (!name || !phone || !address) {
                document.getElementById("custName").focus();
                return;
            }

            let msg = "ğŸ›ï¸ *á€á¶ášá”á‰áŸ’á‡á¶á‘á·á‰ááŸ’á˜á¸á–á¸áœáŸá”áŸá¶á™*%0A";
            msg += "---------------------------%0A";
            msg += `ğŸ‘¤ *á¢áá·áá·á‡á“:* ${name}%0A`;
            msg += `ğŸ“ *á‘á¼ášáŸáŸá–áŸ’á‘:* ${phone}%0A`;
            msg += `ğŸ“ *á‘á¸áá¶áŸ†á„:* ${address}%0A`;
            msg += "---------------------------%0A";
            msg += "ğŸ“¦ *á‘áŸ†á“á·á‰áŠáŸ‚á›á”á¶á“á€á˜áŸ’á˜á„áŸ‹:*%0A";
            
            cart.forEach(item => {
                msg += `â€¢ ${item.name} (${item.quantity} á‚áŸ’ášá¿á„) = $${(item.price * item.quantity).toFixed(2)}%0A`;
            });
            
            msg += "---------------------------%0A";
            msg += `ğŸ’° *áŸášá»á”áŸá¶á…áŸ‹á”áŸ’ášá¶á€áŸ‹:* ${document.getElementById("cartTotal").innerText}%0A`;
            msg += "---------------------------%0A";
            msg += "ğŸ‘‰ *áŸá¼á˜á¢áá·áá·á‡á“ášá„áŸ‹á…á¶áŸ†á€á¶ášá‘á¶á€áŸ‹á‘á„á˜á€áœá·á‰!*";

            window.open(`https://t.me/${TELEGRAM_USER}?text=${msg}`, "_blank");
        }

        // Search logic
        [document.getElementById('searchInput'), document.getElementById('searchInputMobile')].forEach(input => {
            input.addEventListener('input', (e) => {
                const val = e.target.value.toLowerCase();
                filteredProducts = allProducts.filter(p => p.name.toLowerCase().includes(val));
                renderProducts(true);
            });
        });

        document.getElementById("loadMoreBtn").onclick = () => {
            displayedCount += 15;
            renderProducts(false);
        };

        window.onload = fetchProducts;
    </script>
</body>
</html>
